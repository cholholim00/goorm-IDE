import pandas as pd

# 1. 실습용 데이터프레임 생성 (날짜별 판매 데이터 가정)
data = {
    '판매량': [100, 150, 130, 180, 200],
    '지출액': [80, 100, 110, 120, 130]
}
df = pd.DataFrame(data, index=['1일차', '2일차', '3일차', '4일차', '5일차'])

print("--- [1] 원본 데이터 ---")
print(df)
print("-" * 30)

# 2. 통계 및 요약 연산
print("--- [2] 주요 통계 연산 ---")
print(f"전체 판매량 합계: {df['판매량'].sum()}") # 합계
print(f"일평균 지출액: {df['지출액'].mean()}") # 통계
print("\n[전체 요약 통계량]")
print(df.describe()) # 주요 계측치 한눈에 보기
print("-" * 30)

# 3. 데이터 변화량 및 순위 연산
print("--- [3] 변화량 및 순위 연산 ---")
# 전날 대비 판매량 차이 (150 - 100 = 50)
df['판매변화량'] = df['판매량'].diff()

# 전날 대비 판매 성장률 (100에서 150이 되었으므로 0.5)
df['판매성장률'] = df['판매량'].pct_change()

# 판매량 순위 (값이 클수록 1등)
df['판매순위'] = df['판매량'].rank(ascending=False)

# 4. 누적 및 이동 연산
print("--- [4] 누적 및 이동 평균(Rolling) 연산 ---")
# 판매량 누적 합계
df['누적판매량'] = df['판매량'].cumsum()

# 3일 이동 평균 (현재 포함 직전 3개 데이터의 평균)
df['3일이동평균'] = df['판매량'].rolling(window=3).mean()

print(df)